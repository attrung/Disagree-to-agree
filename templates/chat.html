<html>
    <head> 
        <title> Chat room </title>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    </head>
    <body> 
        <script type="text/javascript"> 
            $(document).ready(function() {
                var username = '{{ user }}'
                var socket = io.connect('http://127.0.0.1:5000');

                socket.on('message', function(msg) {
                    if (msg=="!exit") { 
                        window.location.href = '/'
                    }});

                $('#sendbutt').on('click', function() {
                    var message = $('#message-input').val()
                    socket.send($('#message-input').val());
                    $('#message-input').val('');
                    $.ajax({
                            type : "POST",
                            url : "http://127.0.0.1:5000/chat",
                            data: JSON.stringify({"msg": message}),
                            dataType:"json",
                            contentType: 'application/json;charset=UTF-8',
                            success: function() {
                                console.log("Success")
                            }
                        });
                });

                });

        </script>
        <div> Welcome to the chat room. You are chatting with a user. </div>
        <div> Type "!exit" if you want to stop chatting and return to the homepage. </div>
        <div id="message-display"> </div>
        <input type="text" id="message-input"> 
        <button id="sendbutt"> Send </button>
    </body>
</html> 
